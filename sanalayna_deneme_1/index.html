<!DOCTYPE HTML>
<html>
  <head>
    <title>Webcam over WebSocket using OpenCV and Tornado</title>
    <meta charset="utf-8">
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js" integrity="sha512-n8IpKWzDnBOcBhRlHirMZOUvEq2bLRMuJGjuVqbzUJwtTsgwOgK5aS0c1JA647XWYfqvXve8k3PtZdzpipFjgg==" crossorigin="anonymous"></script>
    <script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        #front-camera{
            width: 640px; 
            height:480px;
        }
        #start-record{
            color: #fff;
            width: 120px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color:#00b365 ;
            border: 2px solid #009152;
            cursor: pointer;
        }
        #start-record:hover{
            background-color: #03fc90;
        }
        #start-record:focus{
            color: #000;
            background-color: #fff;
        }
        #time-left{
            position: fixed;
            top: 15px;
            right: 15px;
        }
    </style>
</head>
  <body>
      <div id="time-left"></div>
      <button id="start-record">Başlat</button>
      <video id="front-camera"></video>
      <div style="width:250px">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2680 1221" style="enable-background:new 0 0 2680.394 1220.909;version:1.1"><path d="m372 88c2 6 3 13 3 15 0 0 0 1 0 1-14 5-7 10-4 20 3 9 7 13 9 22 3 13 20 27 32 34l21 13c4 2 12 13 12 13 0-2-1-9 0-9 1 2 45 19 51 21 6 4 11-1 15 2 7 4 2 3 2 9-3 1-4 11-4 13 0 5 0 6-3 10-2 2-3 2-3 5 0 6-11 12-16 12 0 4-7 5-10 4-7-2-10-1-17-1-12 5-15-8-17-16-6 22-20 0-37-3-11-2-34-1-38 11-4 9-11 11-19 6-17-9-24-1-42 1-7 1-11 6-11 12-1 12-4 10-11 17-2 10-28 34-38 34-9 0-28 15-37 20-5 3-12 5-16 8-7 6-6 16-15 22-7 4-17 12-25 22-11 13-20 28-31 28 0-15 14-22 9-41-4-14 10-19 22-25 9-5 60-27 58-35-6-21-46 12-49 1-12 0-19 3-32 1-4 1-21 4-22-2-3 0-1-9-1-11 0-2-6-9-1-10 0-1 0 0 1-1 0 0 0 0 0 0 0 0 1 0 1-1l7-1c7-3 16-19 18-27 1-7 7-5 13-5 4 0 1-5 0-6-4-5 0-4 1-8 0-5-3-8-3-13 0-4 4-5 0-8-2-1 2-3 2-5 0-2-2-2-3-4 0-1 3-12 3-15 7 0 10 2 15-4 5-8 10-9 19-8 9 2 5-11 5-17-4-12-2-22-2-34-4-1-10-1-13-5-2-3-1-6-4-8-3-2-11-2-12-4l-6-4c-1-7 0-5 1-11 2-12 8-5 18-7 6-1 9-2 11-8 1-4 0-6 0-11 0-2 4-6 6-7 2-2 2-4 5-1 3 3 9 4 13 2 3-1 2-5 7-5 5 0 4 6 8 1 3-4 12 0 15-6 1-3 4-2 6-5 1-2 2-6 2-8 3 0 6-1 8-1 3 0 7 8 11 6 6-3 4-8 13-7 8-1 13 8 15 14 2 5 9 10 13 11 3 1 6 4 7 7 2 3 4 3 5 0 1-2 10-6 12-6 6 0 7-4 14-1 2 2 7 5 8 2 2-5 6-10 11-6 2 1 4 1 6 1 3 0 7 0 9 0zm-50 267c-1-1-1-1-2-2-1-1-2-2-3-2-1 0-1 0-2 0v4c0 2 0 3 0 4 0 0 0 0 0 0 1 0 3 1 3 2 2 1 3 3 5 4 1 0 3 1 3-1 0-2 0-4-1-5l-3-5zm14-20c-2 1-3 1-5 2-3 3-11 8-16 7-4-1-6-4-8-8-1-2-2-4-2-6 0-3 7 0 10-1 4-1 9-2 13-2 2 0 5 0 6 0 2 0 2 3 1 5l-1 2zm-26 23c0-1 1-2 1-3 0-1 0-1 0-2 0 0-1-1-1-2-1-1-2-1-3-1-1 0-2 0-2 0-1 0-1 1-2 1 0 0-1 1-1 1 0 0-1 2-1 2 0 1 0 1 0 2 0 1 0 1 0 2 1 1 1 2 2 3 2 1 4 0 6 0l1-4zm-215 43c-2 2-8 3-10 4-6 1-25 7-25 15 6 1 7 7 14 5 5-1 11-4 17-4 4 0 17 1 16-4-1-4-6 0-4-7 1-4-3-4-3-7l-5-3zm19 70c-2 1-4 0-6 0-2 0-11-2-6 2 2 1 3 3 5 3 1 0 3 1 4 2 0 0 0 1 1 1l0 0c1 0 1 1 2 1 0-1 1-1 1-2 0-1 0-1 0-2 0-1 0-1 0-2l-2-4zm242 557c1-4 0-11-1-14-1 1-2 3-3 4-2 2-5 2-7 4-3 4 2 5 4 8 1 1 2 2 2 4 1 1 2 4 4 2l1-8zm2084-784l-3 5c1 3 3 10 6 12l22 13c5 3 1 14 3 20 5 8 8 12 8 22 0 7-2 10-4 17-1 4-10 16-13 17-2 0-6 4-6 5-2 4-5 4 2 7 6 6 3 10 1 17-1 5 2 9 5 14 1 3 6 2 7 4 3 7-7 6-1 9 1 1 4 5 4 6 0 4-3 2-5 4l-2 2c0 14 16 7 23 14 3 3 8 7 11 8 3 1 11 5 11 5 10-5 25-8 36-11 8-2 29 14 34 20 1 1 4 2 4 4 1 2 2 4 2 7 0 2 3 5 5 6l2 5c1 0 1 1 2 1 2 1 10 1 10 3 0 4 0 4 3 7 1 2 4 4 6 5 3 3 7 7 7 10 0 1 0 2 0 3l-10-8c-4-6-10-3-14-9-3-4-1-10-7-4-3 3-7 5-10 9-2 2-5 2-5 6 0 6 2 10-2 15-1 1-4 2-5 4-2 4 0 5 0 8 0 6 0 11-1 17 0 1-9 4-11 5-5 3-4 4-9 0-4-3-3-6-8-3-4 2-7 3-11 1-2-1-5-5-7-3-6 8-6 4-1 13 1 3 2 8 1 11-3 12 1 4 7 12 2 3 9 9 9 13 2 5 2 6-2 9-2 1 2 6 2 8 0 4-5 4-5 7 0 5 9 24 14 25 2 1 3 3 4 4 2 3-2 6-3 10 0 2 0 4-1 5-1 2-3 3-3 6 8 10 11 15 8 28-1 4 0 8-1 12-1 2 0 14 2 15 4 3 8 4 12 2 6-3 3-1 8 1 7 4 7 4 3 10-3 5-9 6-11 12 1 7 1 12-4 16-5 3 0 3-4 7-4 4-7 14-10 19-3 4-2 8-4 13-4 10 9 6 15 8 4 1 6 0 6 4 0 5 1 6 5 7 3 0 1 8 8 7 6-1 4-4 9 0 3 2 5 5 7 8 3 3-7 8-7 13 0 3 6 4 5 8-1 3 1 6 0 9-1 3-3 5-4 7-4 10 8 9 8 17 0 3 4 3 6 3 3 0 3 0 3 3 0 7 14 7 13 14-1 4-5 5-6 9-1 2 2 10 1 11h-6c-5-1-8-3-12-4-3-1-5 3-7 5-6 7-15 17-25 18-9 1-4 3-7 9-1 2-4 4-5 6-2 0-5-3-6-4-4-5-2-11-8-15-2-2 0-11 3-12 4-2 9 1 8-4 0-3-1-11-3-13-4-3-13-10-18-10-8 0-17 0-22 8-1 2-1 4-3 6-3 4-12 2-13 6 0 0 0 0-1 0-1-5-9-6-13-6-8 0-9 5-17-1-5-5-9 3-15-1l-13-9c-2-1-3-5-5-4-4 2-8 6-11 1-4-5-12-4-14-8-4-6-18 3-21 7-3 4-11 1-14 0-5-1-12-6-17-5-2 0-7 10-8 12-1 4-4 4-6 6-1 1-1 4-2 5-2 2-7 11-9 11-5 2-13 2-19 3l-13 5c0-2 0-6-1-8-2-5-2-5 0-10 2-6-8-8-12-10-3-1-4-3-6-4l-6 7c-2 2-3 3-5 4-1 1-3 3-4 4-3 3-7 5-11 7-2 1-6 1-8 2-15 6-32 4-46 9-16 6-30 3-47 6-7 1-21-1-27-5-5 0-11-3-16-5-5-2-9 2-13 2-3 0-6-2-10-1-5 1-12 4-17 7-9 5-15 8-25 10-4 1-7 4-11 6-7 5-13 12-20 16-7 4-17 4-22 7-5 3-10 7-15 9-8 3-16 7-25 8-10 1-24 1-33 6-7 3-20 5-27 6-10 1-15 3-25-1-13-6-40-6-54-4-6-6-9-13-18-18-7-4-14-10-22-11-15-3-32-10-45 1-12 9-34 17-49 22-9 3-29 8-35 15-7 9-9-2-19-1-7-2-14-3-21 0-5 2-10-5-13 3-1 4-4-2-6-3-6-5-3-3-1-8 1-2-7-9-9-9-9-4-24-4-34-6-8-1-10 4-13 10 0 2 1 6 0 7-1 2-5 3-6 6-3 5 3 12 2 17 0 4-3 6-5 9-1 3 0 4 0 6 0 3 7 16 10 18 9 4 2 8 6 12 2 2 5 4 2 8-1 2-10 4-12 4-6-2-13-1-17 3-2 2-6-3-9-2-1 4-2 6-4 9-1 2 4 4 1 9 0 4 4 8 2 12-2 3-2 7-6 8-3 1-5-2-7-2-2 7 1 7-7 7-6 0-10 10-10 15 0 1 1 12-1 9-3-3-4-6-8-9-2-1-6-1-8-3-3-3-1-5-8-5l-9-1c3-4 6-9 8-13 3-7-8-16-7-24-5-7-11-15-15-22-4-7-4-6 1-13 8-10 19-18 28-28 4-5 23-12 23-14 2-4 0-10 0-15 0-15-5-29-18-36-1 0-7-6-8-3-4 1-14 14-16 18-6 10-10 11-20 9-26-4 1 20-11 23 0 14-11 9-20 7-13-2-14 5-22 5-4-12-71-44-81-41-26 5-86 52-86 78 0 1-14 14-16 14 0 0 0 0 0 1-3 0 0-13-9-12-8 1-11 18-20 17-1 2-4 3-5 5 0 1 0 5-1 5 0 0 0 0-1 0h0c-3-10-13-7-15 2-7 1-11-6-20-1-1 0-4 3-5 2h0c-1-5-38-2-40 7-14 0-15-1-29 5-15 7-23 2-38-4-32-13-38-33-58-57-12-15-24-16-37-28-5 0-34-10-37-14-9-11-24-11-35-19-15-11-85-7-87-15 0 0-1 0-1 0-1 0-6 2-7 3-15 3-2 48-13 55-2 12-9 15-4 30 1 4-9 23-13 24-4-12 0-8-11-13-7-3-17-7-23-1-10 10-5 2-14 5-3 1-4 5-7 5-4 0-7-4-11 1-4 5-5 7-11 11-11 9-6-1-14 0-3 1-5 2-8 1-6-3-9-7-15-10-7-3-16-2-24-6-8-3-12-6-16-12-3-5-11-6-16-10-5-4 0-6-1-9-3-6-2-7-1-14 2-9-12-6-13-7 0-2 2-8 3-9v0c1 0 6-10 5-10v0c-3-1-6-2-8-3-1-1-7-7-7-7-2 0-15 8-15 10 0 5 5 3 4 8-4 1-6 7-8 5-2-3-5-9-5-12-2-6-12-8-17-7-13 3-5-10-5-14 0-2-7-4-8-7-5 2-2 14-13 2-9-10-3 9-14 5-5-2-4-7-12-7-8 1 2 15 1 16-7 8-15 4-18 16-3 12-16 15-23 7-4-5 7-1 12-4 1 0 4-4 2-5 0-5-11-4-14-5 0-3 10-8 13-10 3-2 8-12 3-10-7 2-25 13-34 7-10-6-17 1-20 10-3 8-20 1-28 5-4 2-10-4-14-6 0-3 5-2 6-4 2-2 1-5 4-6 6-2 13 1 19-2 4-1 8-8 11-7 9 4 7 7 17 3 9-3 17-1 27-1 16 1-4-19 7-23 6-2 17 4 20-3 5-10 9-8 16-15l-49 3c-9 1-58 11-64 5-16-15-11 1-25 6-4 1-8-21-2-26 3-3 9-10 13-9 7 1 9 16 17 9 8-7-3-11 10-17 10-6 7-15-1-8-7 7-5-2-13-2 0-7 2-6-5-8-2-1-8-7-6-9 2-2 8-5 1-4-4 0-9 9-12 7-3-2-15 2-12-5 4-10 0-14-2-23-1-4 3-15-1-17-6-3-16-6-23-6 0-9 8-6 15-7 11-2 14-6 18-15 4-8-7-6 1-14 2-2 3-15-2-17-13-7-18-1-29-14-23-8-22 17-28-13-1-7-5-3-7-7-5-7-1-6-13-6-12 0-3 21-12 18-9-3-15-20-26-21-14-1-7-5-16-10-3-1-7-2-1-5 5-2 4-20 9-9 1 2 2 9 7 5 3-3 6-2 9-4 4-4 9-24-2-21-8 2-1-4-4-8-6-11-10-28 8-26 9 1 20 23 24 30 5 9-8 8-2 14 3 4 7 20 7 7 0-9 10-15 12-2 1 9 23 2 28 0 12-5 17-1 27-11-9 0-28 3-32-4-6-10-12-19-21-26-2-2-7-19-7-19 6-6 16-2 23-2 10-1-5-9 4-12 8-4 16-5 16-15 0-3-12-3-15-4 0-2-17 2-21-12-4-14 22-4 11-22-4-7-13-3-15-12-3-14-9-9-20-12 0-4 3-7 3-11 0-3-8-11-2-11 9-1 14 18 23 4 4-6 4-11 12-11l0-6 0 0c10 0 11-7 9-17h0c0-1-6 3-8 2-5-1-8-2-14-2-11 1-23 3-33 7-16 7-43 14-59 9 0-8 3-15 8-21 8-14 2-38 3-55 1-23 8-9 22-21 4-3 9-13 11-17 3-5 0-6 0-11 4-1 8-2 12-3 5-2 10-10 11-11 0 0 0 0 0-1 12-4 16-20 25-24 13-5 29 12 38-4 10-4 6-7 16-3 5 1 11-1 13-6h1c0 4 5 8 4 13 0 5-1 3 4 7 5 4 20 12 26 11 7-2 11-6 19-5 12 1 8 6 18-4 4-4 10-6 4-7-5-1-42-20-7-23 11-1 18 5 30 5 0 6-6 11-11 14-5 3-10 11 0 9 5-1 10 0 14-1 11-1 19-6 30-5l28 0c7 0 9 2 15 4 6 2 16 3 21-2 10-5 17 3 27 5 8 2 17-2 21-8 1-2 8-6 10-6v0c-4 0-10-4-14-6-6-4-15 4-23 1-4-2-7-7-11-9-6-5 5-9 4-9 11-6 19-14 32-16 9-2 19 2 26 0 5-1 11-8 15-8 12 0 13-4 23 0 3 1 11-1 15-2l7 0c2 1 26 0 29-1 0-2-1-1-1-2-5 0-6-4-13-1-8 3-10-2-16-4-5-1-10 1-15 1-6 0-15-5-20-2-4 2-6 5-10 3-3-1-3-6-5-7-2-2-6-2-9-2 0-5 3-5-2-8-3-2-7-5-11-7-5-2-17-10-19-15-1-1-2-3-3-5-2-9 7-12 7-20 1-18 14-24 32-21 11 2 22 4 32 9 9 5 22 0 32 2 4 0 8 2 12 3 16 2 36 3 49-7 8-6 6-5 16 0 8 4 13 6 23 6 5-4 23 7 29 10 8 4 20 3 28 2 7-1 13 2 19 1 10-2 25-7 32-13 9-7 6-12 8-22 10-17 33-19 47-34 6-6 29-22 36-22 13 0 20-8 27-18 6-9 9-5 19-8 6-2 11-9 16-13 11-8 37-6 51-11 15-4 37-15 51-23 17-10 26-3 45-2 30 2 52-3 81 7 8 2 21 0 29 0 4 0 9-3 13-2 3 1 4 6 9 5 11 2 36 1 42-9 8-13 5-18 22-18l0 0c0 16 5 11 18 11v1c-40 0 23 74 61 73 15 0 24-11 40-16 15-5 27 10 27 26 0 10-4 18 4 26l33 30c11 11 29-13 31-22 19 0 44 8 48 28 2 9 17 14 25 14 3 0 14-1 15 2 1 4 11 8 15 8 10 1 9 11 24 11 13 0-4-16 5-18 0-1 9 2 11 2 18 0 9 26 32 25 9 0 13 0 22 4 8 3 15-1 22 1 10 2 17 6 28 8 10 2 10-10 17-11 4 0 6 6 12 5 10-2 8-9 19-9 3 0 6-5 8-6 3-2 9 1 11-1 9 1 21-7 27-3 16 9 33-24 44-5 3 6 8 11 14 14 9 4 18-9 29 4 8 10 16-4 25 4 11 10 26 8 36-2 4-4 5-9 12-11 6-1 18 2 22-2 18 2 18-8 29-16 11-8 15-5 26-8 18-5 25-24 42-29 14-4 24-21 34-31 1-1 1-2 2-3l10 6c4 2 5 4 10 2 1-1 12 3 13 5 3 4 3 7 9 2 3-3 12-15 16-13 2 1 5 5 8 5 4 0 7-2 11-2 9-2 19 5 28 7l14 3c4 1 8 3 12 3 0-2-1-7 1-9 7-5 4-3 6-12 2-10 14-10 21-8 4 1 12-1 11 3-1 5-3 10 1 15 7 8 9-7 13 1 2 4 6 2 7 7 1 3 2 7 4 10 4 5 11 2 14 8 2 4 8 6 13 6l4 3-5 7c2 3 3 2 4 6 1 4 1 9 7 8 4-1 7-5 11-5 4 0 13 0 14 4 1 3 1 9 3 11z" fill="#E30A17"/><g fill="#fff"><path d="m1224 864c-151 0-273-122-273-273s122-273 273-273c81 0 153 35 203 91-60-95-167-159-288-159-188 0-341 153-341 341s153 341 341 341c121 0 228-63 288-159-50 56-122 91-203 91z"/><polygon points="1644 591 1716 491 1599 530 1526 429 1526 553 1408 591 1526 630 1526 754 1599 653 1716 692"/></g></svg>
    </div>
    <script>
            //Gerekli tüm değişkenleri tanımla
            var frontCamera = document.getElementById("front-camera");
            var frameSizes = {
                width:frontCamera.clientWidth,
                height:frontCamera.clientHeight
            };
            var stopRecording = false;
            var object;
            var timeLeftElement = document.getElementById("time-left");
            var startBtn = document.getElementById("start-record");
            var positions = [[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]];
            var rotations = [[0,0,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,3,0],[0,15,0],[0,30,0],[0,45,0],[0,3,0],[0,3,0]];
            var scene = new THREE.Scene(); 
            var camera = new THREE.PerspectiveCamera( 25, window.innerWidth / window.innerHeight, 1, 20000 );
            var outputVideo = document.createElement("video");
            outputVideo.width = frameSizes.width;
            outputVideo.height = frameSizes.height;
            var recordedVideo = document.createElement("video");
            recordedVideo.width = frameSizes.width;
            recordedVideo.height = frameSizes.height;
            var mergedCanvas = document.createElement("canvas");
            mergedCanvas.width = frameSizes.width;
            mergedCanvas.height = frameSizes.height;
            var videoStream = mergedCanvas.captureStream(30); // the parameter is the desired framerate, see the MDN doc for more info
            var mediaRecorder = new MediaRecorder(videoStream);
            var chunks = [];

            var videoStream_1 = frontCamera.captureStream(30); // the parameter is the desired framerate, see the MDN doc for more info
            var mediaRecorder_1 = new MediaRecorder(videoStream_1);
            var chunks_1 = [];
            let constraintObj = { 
            audio: false, 
                video: { 
                    facingMode: "user"
                } 
            }; 
            
            //handle older browsers that might implement getUserMedia in some way
            if (navigator.mediaDevices === undefined) {
                navigator.mediaDevices = {};
                navigator.mediaDevices.getUserMedia = function(constraintObj) {
                    let getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;
                    if (!getUserMedia) {
                        return Promise.reject(new Error('getUserMedia is not implemented in this browser'));
                    }
                    return new Promise(function(resolve, reject) {
                        getUserMedia.call(navigator, constraintObj, resolve, reject);
                    });
                }
            }else{
                navigator.mediaDevices.enumerateDevices()
                .then(devices => {
                    devices.forEach(device=>{
                        console.log(device.kind.toUpperCase(), device.label);
                        //, device.deviceId
                    })
                })
                .catch(err=>{
                    console.log(err.name, err.message);
                })
            }

            navigator.mediaDevices.getUserMedia(constraintObj)
            .then(function(mediaStreamObj) {
                //mediaStream ı ön kameranın gösterileceği video elemmentine bağla
                let cam_view = frontCamera;
                if ("srcObject" in cam_view) {
                    cam_view.srcObject = mediaStreamObj;
                } else {
                    //old version
                    cam_view.src = window.URL.createObjectURL(mediaStreamObj);
                }
                
                cam_view.onloadedmetadata = function(ev) {
                    console.log(mediaStreamObj);
                    //show in the video element what is being captured by the webcam
                    cam_view.play();
            };
         });

            startBtn.addEventListener("click",function(){
                mediaRecorder_1.start();
                countdown(2);
            });

            mediaRecorder_1.ondataavailable = function(e) {
                chunks_1.push(e.data);
            };
            mediaRecorder_1.onstop = function(e) {
                var blob_1 = new Blob(chunks_1, { type : 'video/mp4' }); // other types are available such as 'video/webm' for instance, see the doc for more info
                chunks_1 = [];
                var videoURL_1 = URL.createObjectURL(blob_1);
                recordedVideo.src = videoURL_1;
                recordedVideo.play();
            };

            mediaRecorder.ondataavailable = function(e) {
                chunks.push(e.data);
            };
            mediaRecorder.onstop = function(e) {
                var blob = new Blob(chunks, { type : 'video/mp4' }); // other types are available such as 'video/webm' for instance, see the doc for more info
                chunks = [];
                var videoURL = URL.createObjectURL(blob);
                outputVideo.src = videoURL;
                outputVideo.controls = true;
                document.body.appendChild(outputVideo);
            };
            camera.position.set( 1, 1, 20 );
            
            // Load a Renderer
            var glassesCanvas = document.createElement("canvas");
            var renderer = new THREE.WebGLRenderer({ alpha: true , canvas:glassesCanvas});
            renderer.setClearColor( 0x000000, 0 ); // the default
            renderer.setPixelRatio( window.devicePixelRatio );
            renderer.setSize(frameSizes.width, frameSizes.height);
            
            // Load the Orbitcontroller

                    
            // Load Light
            var ambientLight = new THREE.AmbientLight( 0xcccccc );
            scene.add( ambientLight );
                    
            var directionalLight = new THREE.DirectionalLight( 0xffffff );
            directionalLight.position.set( 0, 1, 1 ).normalize();
            scene.add( directionalLight );				

            // glTf 2.0 Loader
            var loader = new THREE.GLTFLoader();				
            loader.load( './gltfmodel/scene.gltf', function ( gltf ) {         
            object = gltf.scene;				
            object.scale.set( 0.01, 0.01, 0.01 );			   
            object.position.x = 0;				    //Position (x = right+ left-) 
            object.position.y = 0;				    //Position (y = up+, down-)
            object.position.z = 0;			    //Position (z = front +, back-)
            scene.add( object );
            
            
            fc = new frameExtractor(recordedVideo,glassesCanvas,mergedCanvas,positions,rotations);
            });	 
            
            function renderGlassFrame(positionsArray,rotationsArray){
                        if(rotations[0]==undefined || rotations[0]==null){
                        return 
                        }
                        else{
                            object.rotation.x = THREE.Math.degToRad(rotations[0][0]);
                            object.rotation.y =THREE.Math.degToRad(rotations[0][1]);
                            object.rotation.z = THREE.Math.degToRad(rotations[0][2]);
                            object.position.x = positions[0][0];
                            object.position.y = positions[0][1];
                            object.position.z = positions[0][2];
                            positions.splice(0, 1);
                            rotations.splice(0, 1);
                            renderGlass();
                            //setTimeout(function(){renderPerFrame(positions,rotations);}, 3000);
                        }
            }
            
            function countdown(secondsForWait){
                    this.timer = setInterval(function(){
                        if (secondsForWait == -1) {
                            stopRecording = true;
                            mediaRecorder_1.stop();
                            clearInterval(this.timer);
                            return
                        } else {
                            timeLeftElement.innerHTML="<b>"+secondsForWait+"</b>"+" saniye sonra kayıt duracak...";
                            secondsForWait--;
                        }
                    }, 1000);
                    return;
                }
            function frameExtractor(video,canvas,mergedCanvas,positionsArray,rotationsArray) {
                this.positionsArray = positionsArray;
                this.rotationsArray = rotationsArray;
                // Set up our frame converter
                this.video = video;
                this.viewport = mergedCanvas.getContext("2d");
                this.width = frameSizes.width;
                this.height = frameSizes.height;
                // Create the frame-buffer canvas
                this.framebuffer = document.createElement("canvas");
                this.framebuffer.width = this.width;
                this.framebuffer.height = this.height;
                this.ctx = this.framebuffer.getContext("2d");
                this.ctx1=canvas.getContext("2d");
                var self = this;
                var now = new Date().getTime()
                // Start rendering when the video is playing
                this.video.addEventListener("play", function() {
                    mediaRecorder.start();
                    self.render();
                }, false);
                // Rendering call-back
                this.render = function() {
                    if (this.video.paused || this.video.ended) {
                        mediaRecorder.stop();
                        return;
                    }
                    this.renderFrame();
                    var self = this;
                    setTimeout(function () {
                        self.render();
                    }, 33);
                };
                // Compute and display the next frame 
                this.renderFrame = function() {
                    // Acquire a video frame from the video element
                    renderGlassFrame(this.positionsArray,this.rotationsArray);
                    this.ctx.drawImage(video,0,0,this.width, this.height);
                    this.ctx.drawImage(canvas,0,0,this.width, this.height);
                    var data = this.ctx.getImageData(0, 0, this.width, this.height);
                    this.viewport.putImageData(data, 0, 0);
                    return;
                };
                function renderGlassFrame(positions,rotations){
                            if(rotations[0]==undefined || rotations[0]==null){
                            return 
                            }
                            else{
                                object.rotation.x = THREE.Math.degToRad(rotations[0][0]);
                                object.rotation.y =THREE.Math.degToRad(rotations[0][1]);
                                object.rotation.z = THREE.Math.degToRad(rotations[0][2]);
                                object.position.x = positions[0][0];
                                object.position.y = positions[0][1];
                                object.position.z = positions[0][2];
                                positions.splice(0, 1);
                                rotations.splice(0, 1);
                                console.log(object.rotation.y);
                                renderGlass();
                                //setTimeout(function(){renderPerFrame(positions,rotations);}, 3000);
                            }
                }
                function renderGlass() {
                        renderer.render( scene, camera );
                }
        }

            
            let socket = new WebSocket("ws://localhost:8089/ws");
            socket.onopen = function(){
                console.log("websocket bağlantısı başarılı.");
            }
            socket.onerror = function(error) {
                alert(`[error] ${error}`);
                console.log(error);
            };
            
            // message received - show the message in div#messages
            socket.onmessage = function(event) {
            let message = event.data;

            let messageElem = document.createElement('div');
            messageElem.textContent = message;
            document.getElementById('messages').prepend(messageElem);
            }




    </script>
  </body>
</html>